<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîç Teste de LocalStorage - Sistema Cart√≥rio</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        button {
            padding: 12px 24px;
            margin: 5px;
            font-size: 14px;
            font-weight: bold;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            color: white;
        }
        .btn-test { background-color: #3498db; }
        .btn-view { background-color: #27ae60; }
        .btn-clear { background-color: #e74c3c; }
        .btn-test:hover { background-color: #2980b9; }
        .btn-view:hover { background-color: #229954; }
        .btn-clear:hover { background-color: #c0392b; }
        #output {
            margin-top: 20px;
            padding: 20px;
            background-color: #ecf0f1;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            white-space: pre-wrap;
            max-height: 600px;
            overflow-y: auto;
        }
        .success { color: #27ae60; font-weight: bold; }
        .error { color: #e74c3c; font-weight: bold; }
        .info { color: #3498db; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç Teste de LocalStorage - Sistema Cart√≥rio</h1>
        
        <p>Use esta p√°gina para testar se o localStorage est√° funcionando corretamente:</p>
        
        <div>
            <button class="btn-test" onclick="testarGravacao()">
                üíæ Testar Grava√ß√£o
            </button>
            <button class="btn-view" onclick="verTodosDados()">
                üìä Ver Todos os Dados
            </button>
            <button class="btn-view" onclick="verClientes()">
                üë§ Ver Clientes
            </button>
            <button class="btn-view" onclick="verFuncionarios()">
                üë• Ver Funcion√°rios
            </button>
            <button class="btn-clear" onclick="limparTudo()">
                üóëÔ∏è Limpar Tudo
            </button>
        </div>
        
        <div id="output"></div>
    </div>

    <script>
        function log(message, type = 'info') {
            const output = document.getElementById('output')
            const span = document.createElement('span')
            span.className = type
            span.textContent = message + '\n'
            output.appendChild(span)
        }

        function limparOutput() {
            document.getElementById('output').innerHTML = ''
        }

        function testarGravacao() {
            limparOutput()
            log('üß™ TESTE DE GRAVA√á√ÉO INICIADO', 'info')
            log('‚ïê'.repeat(60), 'info')
            
            try {
                // Teste 1: Gravar cliente
                log('\n1Ô∏è‚É£ Testando grava√ß√£o de CLIENTE...', 'info')
                const clientes = JSON.parse(localStorage.getItem('clientes-cadastrados') || '[]')
                const novoCliente = {
                    codigo: (clientes.length + 1).toString(),
                    nome: 'TESTE DIAGN√ìSTICO ' + Date.now(),
                    cpf: '111.111.111-11',
                    telefone: '11111111111'
                }
                clientes.push(novoCliente)
                localStorage.setItem('clientes-cadastrados', JSON.stringify(clientes))
                log('   ‚úÖ Cliente gravado! C√≥digo: ' + novoCliente.codigo, 'success')
                
                // Verificar imediatamente
                const verificacao = JSON.parse(localStorage.getItem('clientes-cadastrados') || '[]')
                log('   ‚úÖ Verifica√ß√£o: ' + verificacao.length + ' clientes no total', 'success')
                
                // Teste 2: Gravar funcion√°rio
                log('\n2Ô∏è‚É£ Testando grava√ß√£o de FUNCION√ÅRIO...', 'info')
                const funcionarios = JSON.parse(localStorage.getItem('funcionarios-cadastrados') || '[]')
                const novoFunc = {
                    codigo: (funcionarios.length + 1).toString(),
                    nome: 'FUNCIONARIO TESTE ' + Date.now(),
                    cpf: '222.222.222-22'
                }
                funcionarios.push(novoFunc)
                localStorage.setItem('funcionarios-cadastrados', JSON.stringify(funcionarios))
                log('   ‚úÖ Funcion√°rio gravado! C√≥digo: ' + novoFunc.codigo, 'success')
                
                const verificacaoFunc = JSON.parse(localStorage.getItem('funcionarios-cadastrados') || '[]')
                log('   ‚úÖ Verifica√ß√£o: ' + verificacaoFunc.length + ' funcion√°rios no total', 'success')
                
                log('\n‚úÖ TESTE CONCLU√çDO COM SUCESSO!', 'success')
                log('Os dados foram gravados e verificados.', 'success')
                
            } catch (error) {
                log('\n‚ùå ERRO: ' + error.message, 'error')
            }
        }

        function verTodosDados() {
            limparOutput()
            log('üìä TODOS OS DADOS NO LOCALSTORAGE', 'info')
            log('‚ïê'.repeat(60), 'info')
            
            const keys = [
                'clientes-cadastrados',
                'funcionarios-cadastrados',
                'cartorios-seade',
                'dnvdo-bloqueadas',
                'naturezas',
                'feriados-cadastrados',
                'ultimoCodigoCliente',
                'ultimoCodigoFuncionario',
                'ultimoCodigoCartorio'
            ]
            
            keys.forEach(key => {
                const data = localStorage.getItem(key)
                if (data) {
                    try {
                        const parsed = JSON.parse(data)
                        if (Array.isArray(parsed)) {
                            log(`\nüìÅ ${key}: ${parsed.length} registros`, 'success')
                            if (parsed.length > 0) {
                                log('   Primeiro: ' + JSON.stringify(parsed[0]).substring(0, 100), 'info')
                            }
                        } else {
                            log(`\nüìÅ ${key}: ${data}`, 'success')
                        }
                    } catch {
                        log(`\nüìÅ ${key}: ${data}`, 'success')
                    }
                } else {
                    log(`\n‚ùå ${key}: (vazio)`, 'error')
                }
            })
            
            log('\nüìä Total de chaves: ' + localStorage.length, 'info')
        }

        function verClientes() {
            limparOutput()
            log('üë§ CLIENTES CADASTRADOS', 'info')
            log('‚ïê'.repeat(60), 'info')
            
            const clientes = JSON.parse(localStorage.getItem('clientes-cadastrados') || '[]')
            log(`\nTotal: ${clientes.length} clientes\n`, 'success')
            
            if (clientes.length === 0) {
                log('‚ùå Nenhum cliente cadastrado', 'error')
            } else {
                clientes.forEach((c, i) => {
                    log(`\n${i + 1}. C√≥digo: ${c.codigo}`, 'info')
                    log(`   Nome: ${c.nome}`, 'info')
                    log(`   CPF: ${c.cpf || '(n√£o informado)'}`, 'info')
                })
            }
        }

        function verFuncionarios() {
            limparOutput()
            log('üë• FUNCION√ÅRIOS CADASTRADOS', 'info')
            log('‚ïê'.repeat(60), 'info')
            
            const funcionarios = JSON.parse(localStorage.getItem('funcionarios-cadastrados') || '[]')
            log(`\nTotal: ${funcionarios.length} funcion√°rios\n`, 'success')
            
            if (funcionarios.length === 0) {
                log('‚ùå Nenhum funcion√°rio cadastrado', 'error')
            } else {
                funcionarios.forEach((f, i) => {
                    log(`\n${i + 1}. C√≥digo: ${f.codigo}`, 'info')
                    log(`   Nome: ${f.nome}`, 'info')
                    log(`   CPF: ${f.cpf || '(n√£o informado)'}`, 'info')
                })
            }
        }

        function limparTudo() {
            if (!confirm('‚ö†Ô∏è ATEN√á√ÉO: Isso vai APAGAR TODOS OS DADOS!\n\nTem certeza?')) {
                return
            }
            
            if (!confirm('‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è √öLTIMA CONFIRMA√á√ÉO!\n\nIsso √© IRREVERS√çVEL!')) {
                return
            }
            
            limparOutput()
            localStorage.clear()
            log('üóëÔ∏è Todos os dados foram apagados!', 'error')
            log('Recarregue a p√°gina principal para recome√ßar.', 'info')
        }

        // Mostrar dados ao carregar
        window.onload = () => {
            verTodosDados()
        }
    </script>
</body>
</html>

